FROM node:16 as build
RUN npm install -g typescript
WORKDIR /app
COPY package.json package-lock.json ./
COPY lerna.json ./

RUN mkdir packages
WORKDIR /packages

RUN mkdir shared-module
RUN mkdir transactions-service
WORKDIR /app

COPY ./packages/shared-module/ /app/packages/shared-module
WORKDIR /app/packages/shared-module
RUN npm run build
WORKDIR /app
COPY ./packages/transactions-service/ /app/packages/transactions-service
RUN npm install
WORKDIR /app/packages/transactions-service
EXPOSE 4000
CMD [ "npm", "run", "dev" ]


